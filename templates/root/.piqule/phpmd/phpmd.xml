<?xml version="1.0" encoding="UTF-8"?>
<ruleset xmlns="http://pmd.sourceforge.net/ruleset/2.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         name="Piqule PHPMD Ruleset"
         xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0
                             https://pmd.sourceforge.io/ruleset_2_0_0.xsd">

    <description>
        Numeric-only PHPMD ruleset with intentionally strict thresholds
    </description>

    <!-- Cyclomatic complexity -->
    <rule ref="rulesets/codesize.xml/CyclomaticComplexity">
        <properties>
            <property name="reportLevel" value="<< config(phpmd.cyclomatic)|default(["10"])|join("") >>"/>
        </properties>
    </rule>

    <!-- NPath complexity -->
    <rule ref="rulesets/codesize.xml/NPathComplexity">
        <properties>
            <property name="reportLevel" value="<< config(phpmd.npath)|default(["200"])|join("") >>"/>
        </properties>
    </rule>

    <!-- Method length -->
    <rule ref="rulesets/codesize.xml/ExcessiveMethodLength">
        <properties>
            <property name="minimum" value="<< config(phpmd.method_length)|default(["50"])|join("") >>"/>
        </properties>
    </rule>

    <!-- Class length -->
    <rule ref="rulesets/codesize.xml/ExcessiveClassLength">
        <properties>
            <property name="minimum" value="<< config(phpmd.class_length)|default(["200"])|join("") >>"/>
        </properties>
    </rule>

    <!-- Number of methods -->
    <rule ref="rulesets/codesize.xml/TooManyMethods">
        <properties>
            <property name="maxmethods" value="<< config(phpmd.max_methods)|default(["10"])|join("") >>"/>
        </properties>
    </rule>

    <!-- Too many fields -->
    <rule ref="rulesets/codesize.xml/TooManyFields">
        <properties>
            <property name="maxfields" value="<< config(phpmd.max_fields)|default(["10"])|join("") >>"/>
        </properties>
    </rule>

    <!-- Excessive parameter list -->
    <rule ref="rulesets/codesize.xml/ExcessiveParameterList">
        <properties>
            <property name="minimum" value="<< config(phpmd.max_parameters)|default(["5"])|join("") >>"/>
        </properties>
    </rule>

    <!-- Boolean argument flag -->
    <rule ref="rulesets/cleancode.xml/BooleanArgumentFlag"/>

    <!-- Excessive class complexity (WMC) -->
    <rule ref="rulesets/codesize.xml/ExcessiveClassComplexity">
        <properties>
            <property name="maximum" value="<< config(phpmd.class_complexity)|default(["50"])|join("") >>"/>
        </properties>
    </rule>

</ruleset>
