{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",

  "extends": [
    "config:recommended"
  ],

  "schedule": ["* 1-4 * * *"],
  "timezone": "UTC",

  "labels": ["dependencies"],
  "assignees": [],
  "reviewers": [],

  "prConcurrentLimit": 3,
  "prHourlyLimit": 0,

  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": ["security"]
  },
  "composer": {
    "enabled": true
  },

  "github-actions": {
    "enabled": true
  },
  "dockerfile": {
    "enabled": false
  },
  "packageRules": [
    {
      "description": "Pin GitHub Actions to commit SHA",
      "matchManagers": ["github-actions"],
      "pinDigests": true
    },
    {
      "description": "Auto-merge patch and minor dev dependencies",
      "matchDepTypes": ["require-dev"],
      "matchUpdateTypes": ["patch", "minor"],
      "automerge": true,
      "automergeType": "pr",
      "platformAutomerge": true
    },
    {
      "description": "Group dev dependencies",
      "matchDepTypes": ["require-dev"],
      "groupName": "dev dependencies"
    },
    {
      "description": "Group production dependencies",
      "matchDepTypes": ["require"],
      "groupName": "production dependencies"
    },
    {
      "description": "Prioritize patch updates",
      "matchUpdateTypes": ["patch"],
      "prPriority": 10
    },
    {
      "description": "Group CI toolchain updates",
      "groupName": "CI toolchain",
      "matchManagers": ["github-actions", "custom.regex"]
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update Node.js image version (Dockerfile)",
      "fileMatch": ["(^|/)Dockerfile$"],
      "matchStrings": [
        "ARG NODE_IMAGE=node:(?<currentValue>[^\\s]+)"
      ],
      "depNameTemplate": "node",
      "datasourceTemplate": "docker"
    },

    {
      "customType": "regex",
      "description": "Update actionlint version (Dockerfile)",
      "fileMatch": ["(^|/)Dockerfile$"],
      "matchStrings": [
        "ARG ACTIONLINT_VERSION=(?<currentValue>[^\\s]+)"
      ],
      "depNameTemplate": "rhysd/actionlint",
      "datasourceTemplate": "github-releases"
    },

    {
      "customType": "regex",
      "description": "Update hadolint version (Dockerfile)",
      "fileMatch": ["(^|/)Dockerfile$"],
      "matchStrings": [
        "ARG HADOLINT_VERSION=(?<currentValue>[^\\s]+)"
      ],
      "depNameTemplate": "hadolint/hadolint",
      "datasourceTemplate": "github-releases"
    },

    {
      "customType": "regex",
      "description": "Update typos version (Dockerfile)",
      "fileMatch": ["(^|/)Dockerfile$"],
      "matchStrings": [
        "ARG TYPOS_VERSION=(?<currentValue>[^\\s]+)"
      ],
      "depNameTemplate": "crate-ci/typos",
      "datasourceTemplate": "github-releases"
    },

    {
      "customType": "regex",
      "description": "Update markdownlint-cli2 version (Dockerfile)",
      "fileMatch": ["(^|/)Dockerfile$"],
      "matchStrings": [
        "ARG MARKDOWNLINT_VERSION=(?<currentValue>[^\\s]+)"
      ],
      "depNameTemplate": "markdownlint-cli2",
      "datasourceTemplate": "npm"
    },
    {
      "customType": "regex",
      "description": "Update markdownlint-cli2 version in CI",
      "fileMatch": [
        "\\.github/workflows/.*\\.ya?ml$"
      ],
      "matchStrings": [
        "markdownlint-cli2@(?<currentValue>\\d+\\.\\d+\\.\\d+)"
      ],
      "depNameTemplate": "markdownlint-cli2",
      "datasourceTemplate": "npm"
    },
    {
      "customType": "regex",
      "description": "Update AST Metrics version",
      "fileMatch": ["(^|/)Dockerfile$"],
      "matchStrings": [
        "ARG AST_METRICS_VERSION=(?<currentValue>[^\\s]+)"
      ],
      "depNameTemplate": "Halleck45/ast-metrics",
      "datasourceTemplate": "github-releases"
    }
  ]
}
